!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("commajs-core")):"function"==typeof define&&define.amd?define(["commajs-core"],t):"object"==typeof exports?exports.CommaLists=t(require("commajs-core")):e.CommaLists=t(e["commajs-core"])}(window,function(n){return a={},r.m=o=[function(e,t){e.exports=n},function(e,t,n){"use strict";n.r(t);var P=n(0);function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function a(e,t){return(a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function l(a){var l=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t,n,o,r=c(a);return t=l?(e=c(this).constructor,Reflect.construct(r,arguments,e)):r.apply(this,arguments),n=this,!(o=t)||"object"!==i(o)&&"function"!=typeof o?u(n):o}}function u(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var r=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&a(e,t)}(w,P["Plugin"]);var e,t,n,r=l(w);function w(e){var t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,w);var n,o=(t=r.call(this,e)).rootNode.domElement;return null==t.contextmenuFunction&&(n=u(t),t.contextmenuFunction=function(e){n.EditStartingNumber(),e.preventDefault(),e.stopPropagation()}),o.removeEventListener("contextmenu",t.contextmenuFunction),o.addEventListener("contextmenu",t.contextmenuFunction),t}return e=w,n=[{key:"CreateNew",value:function(o,e){"ordered"==e&&(e="numbered");var t="numbered",n=!1;null!=e&&("string"==typeof e?t=e:(t=e.type,n=e.isTab));var r,a,l,i="padding-left:40px;",u=o.GetStyleAtCurrentCursorPosition();null!=u.nodeStyle&&(null!=u.nodeStyle.fontColor&&(r=u.nodeStyle.fontColor,i=i+"color: "+r.on+";"),null!=u.nodeStyle.fontFamily&&(a=u.nodeStyle.fontFamily,i=i+"font-family: "+a.on+";"),null!=u.nodeStyle.fontSize&&(l=u.nodeStyle.fontSize,i=i+"font-size: "+l.on+";"));var c,s,d,f,p=o.GetSelectedLines(),y=!1,h=!1,m="";if(0<p.length&&(c=[],s=[],d=[],p.forEach(function(e){"ul"==e.tagName.toLowerCase()||"ol"==e.tagName.toLowerCase()?(m=e.tagName.toLowerCase(),y=!0,s.push(e)):"li"!=e.tagName.toLowerCase()||n?d.push(e):(y=h=!0,c.push(e))}),y?h?(p=[],f=c[0].parent,p.push(f),y=!(h=!1),m=f.tagName.toLowerCase()):p=s:p=d),!y){var v=o.GetCursorPosition(),g="ul";"numbered"==t&&(g="ol");var N=P.BlockNode.CreateNew(o,g);N.SetAttributes([{name:"style",value:i}]);var b,C,x=void 0,E=[];return p.forEach(function(e){x=e.parent;var t=P.BlockNode.CreateNew(o,"li");e.children.forEach(function(e){t.Append(e)}),N.Append(t),E.push(e.id)}),null!=x&&(b=x.children,x.children=[],C=!0,b.forEach(function(e){E.indexOf(e.id)<0?x.Append(e):(C&&(x.Append(N),C=!1),o.DeleteNode(e,!0))})),o.GetNodeById(v.idStartNode).SetFocus(v.startOffset),new w(N)}var S=void 0;if("numbered"==t&&"ol"==m||"bulleted"==t&&"ul"==m){var T={},k=[];p.forEach(function(t){"ol"!=t.tagName.toLowerCase()&&"ul"!=t.tagName.toLowerCase()||(k.push(t),T[t.id]=[],t.children.forEach(function(e){"li"==e.tagName.toLowerCase()&&(e.ChangeTagName("div"),T[t.id].push(e))}))}),k.forEach(function(e){var t,n;null!=e&&(t=e.parent,T[(n=e).id].forEach(function(e){t.AppendAfter(n,e),S=n=e}),o.RemovePluginInstance(e.id),o.DeleteNode(e,!1,!1))}),null!=S&&S.GetFirstTextNode().SetFocus()}else{if(p.forEach(function(e){"ul"==(S=e).tagName.toLowerCase()?e.ChangeTagName("ol"):e.ChangeTagName("ul"),e.SetAttributes([{name:"style",value:i}])}),null!=S)return new w(S)}}},{key:"GetName",value:function(){return"lists"}},{key:"GetTagToParseOnPaste",value:function(){return["ul","ol"]}},{key:"CreateNewFromPastedNode",value:function(o,e){var t="ul";"ol"==e.tagName.toLowerCase()&&(t="ol");var n="margin-left:40px;list-style-position: inside;",r=o.GetStyleAtCurrentCursorPosition();null!=r.nodeStyle&&(null!=r.nodeStyle.fontColor&&(n=n+"color: "+r.nodeStyle.fontColor.on+";"),null!=r.nodeStyle.fontFamily&&(n=n+"font-family: "+r.nodeStyle.fontFamily.on+";"));var a=P.BlockNode.CreateNew(o,t);a.SetAttributes([{name:"style",value:n}]);var l=[].slice.call(e.getElementsByTagName("li"));return null!=l&&l.forEach(function(e){var t=P.BlockNode.CreateNew(o,"li"),n=P.TextNode.CreateNew(o,"span",e.textContent.toString(),o.GetDefaultNodeStyle().Copy());t.Append(n),a.Append(t)}),new w(a)}}],(t=[{key:"EditStartingNumber",value:function(){var n,o,e,t,r,a;"ol"==this.rootNode.tagName.toLowerCase()&&(n=this,(o=document.createElement("div")).style.backgroundColor="rgba(0,0,0,0.2)",o.style.width="100%",o.style.height="100%",o.style.position="absolute",o.style.left="0px",o.style.top="0px",o.style.overflow="auto",o.style.zIndex="999",o.style.display="flex",o.style.justifyContent="center",o.style.alignItems="center",(e=document.createElement("div")).style.backgroundColor="#282d36",e.style.borderRadius="10px",e.style.color="#ffffff",e.style.width="200px",e.style.height="100px",e.style.display="flex",e.style.justifyContent="start",e.style.alignItems="center",(t=document.createElement("div")).textContent="Start from:",t.style.fontSize="16px",t.style.padding="0px 10px 0px 20px",e.appendChild(t),r=document.createElement("div"),(a=document.createElement("input")).style.border="none",a.style.width="50px",a.style.padding="4px",a.style.borderRadius="4px",a.style.outline="none",r.appendChild(a),a.addEventListener("blur",function(){try{o.parentNode.removeChild(o)}catch(e){}}),a.addEventListener("keyup",function(e){var t=e.key;if("Enter"==t){""!=a.value&&n.rootNode.AddAttribute("start",a.value);try{o.parentNode.removeChild(o)}catch(e){}}else if("Esc"==t||"Escape"==t)try{o.parentNode.removeChild(o)}catch(e){}}),e.appendChild(r),o.appendChild(e),document.body.appendChild(o),a.focus())}},{key:"ManageDeleteTop",value:function(e){var t;null==e.parent.previous&&(t=e.parent,e.parent.parent.InsertEmptyBlockNodeBefore().Merge(e.parent,!0).SetFocus(),this.rootNode.document.DeleteNode(t),0==this.rootNode.children.length&&this.rootNode.document.DeleteNode(this.rootNode))}},{key:"ManageEnter",value:function(e){var t,n,o,r,a=!1;return null!=e&&null==e.parent.next&&(t=e.parent,n=!0,t.children.forEach(function(e){""!=e.text&&n&&(n=!1)}),n&&(a=!0,r="div",null!=(o=e.parent).parent.parent&&null!=o.parent.parent.GetPluginType()&&"lists"==o.parent.parent.GetPluginType()&&(r="li"),e.parent.parent.InsertEmptyBlockNodeAfter(r).Merge(e.parent,!0).SetFocus(),1==this.rootNode.children.length?this.rootNode.document.DeleteNode(this.rootNode):this.rootNode.document.DeleteNode(o))),a}},{key:"_getLastTextNode",value:function(e){var t=this,n=void 0;return e.children.forEach(function(e){e.isTextNode()&&(n=e),null!=e.children&&0<e.children.length&&(n=t._getLastTextNode(e))}),n}},{key:"_GetLastItem",value:function(){var t=this,n=void 0;return this.rootNode.children.forEach(function(e){n=t._getLastTextNode(e)}),n}},{key:"_getFirstTextNode",value:function(e){var t=this,n=void 0;return e.children.forEach(function(e){null==n&&e.isTextNode()&&(n=e),null==n&&null!=e.children&&0<e.children.length&&(n=t._getFirstTextNode(e))}),n}},{key:"_GetFirstItem",value:function(){var t=this,n=void 0;return this.rootNode.children.forEach(function(e){null==n&&(n=t._getFirstTextNode(e))}),n}},{key:"ManageDeleteFromBottom",value:function(){var e,t,n=this.rootNode.document.selectionManager.GetCurrent().startNode.parent;return n.isBlockNode()&&(e=this._GetLastItem(),t=e.parent,n.children.forEach(function(e){t.Append(e)}),this.rootNode.document.DeleteNode(n),e.SetCarretAtTheEnd()),!0}},{key:"ManageTab",value:function(e){var t={type:"numbered",isTab:!0};return"ul"==this.rootNode.tagName&&(t.type="bulleted"),e.InsertPluginAtSection("lists",t),!0}},{key:"ManageCancelFromTop",value:function(){var e,t,n=this.rootNode.document.selectionManager.GetCurrent().startNode.parent;return n.isBlockNode()&&((t=(e=this._GetFirstItem()).parent).children.forEach(function(e){n.Append(e)}),this.rootNode.document.DeleteNode(t),e.SetFocus()),!0}},{key:"ManageCancelFrombottom",value:function(e){var t,n;return null!=this.rootNode.next&&(!(t=this.rootNode.next).isBlockNode()||null!=t.GetPluginType()&&""!=t.GetPluginType()||(n=e.parent,t.children.forEach(function(e){n.Append(e)}),this.rootNode.document.DeleteNode(t),e.SetCarretAtTheEnd())),!0}},{key:"Fire",value:function(e,t,n){var o=!1;switch(e){case P.PluginActions.DELETE_TOP:o=this.ManageDeleteTop(t);break;case P.PluginActions.DELETE_FROM_BOTTOM:o=this.ManageDeleteFromBottom(t);break;case P.PluginActions.CANCEL_FROM_TOP:o=this.ManageCancelFromTop();break;case P.PluginActions.CANCEL_FROM_BOTTOM:o=this.ManageCancelFrombottom(t);break;case P.PluginActions.ENTER:o=this.ManageEnter(t);break;case P.PluginActions.TAB:o=this.ManageTab(n);break;case P.PluginActions.CLICK:break;default:return}return o}}])&&o(e.prototype,t),n&&o(e,n),w}();t.default=r}],r.c=a,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)r.d(n,o,function(e){return t[e]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="/",r(r.s=1);function r(e){if(a[e])return a[e].exports;var t=a[e]={i:e,l:!1,exports:{}};return o[e].call(t.exports,t,t.exports,r),t.l=!0,t.exports}var o,a});